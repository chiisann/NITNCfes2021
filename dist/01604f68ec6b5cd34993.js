import"./style.css";import*as THREE from"three";import{OrbitControls}from"three/examples/jsm/controls/OrbitControls.js";import{PointLightHelper,SphereBufferGeometry}from"three";import{GLTFLoader}from"three/examples/jsm/loaders/GLTFLoader";import luxy from"luxy.js";import gsap from"gsap";import{ScrollTrigger}from"gsap/ScrollTrigger";gsap.registerPlugin(ScrollTrigger);const textureLoader=new THREE.TextureLoader,gltfLoader=new GLTFLoader;function getRandomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}const canvas=document.querySelector("canvas.webgl"),scene=new THREE.Scene,light=new THREE.Color(16316664),dark=new THREE.Color(16706817),geometry=new THREE.SphereBufferGeometry(.5,64,64),meshParams={color:"#FEED01",metalness:.58,emissive:"#000000",roughness:.18},material=new THREE.MeshPhysicalMaterial(meshParams),sphere=new THREE.Mesh(geometry,material);let japan;var truck,box;sphere.position.set(0,0,-.5),sphere.scale.set(.3,.3,.3),gltfLoader.load("/objects/japan.gltf",(function(e){japan=e.scene;for(let e=0;e<japan.children.length;e++)japan.children[e].castShadow=!0;scene.add(japan),japan.position.set(0,0,0),japan.rotation.set(Math.PI/6,Math.PI/6,0),japan.scale.set(.2,.2,.2);for(let e=0;e<=6;e++){let t,o;e<3?(t=.6*e-1,o=11):3<=e&&e<6?(t=.6*(e-3)-1,o=12):(t=-.4,o=13),tl1.to(japan.children[e].position,{x:t,y:0,z:o,duration:1,scrollTrigger:{trigger:".title h1",start:"top 50%",end:"top top",toggleActions:"restart none reverse none",scrub:1}}),tl1.to(japan.children[e].rotation,{x:-Math.PI/3,z:0,y:0,duration:1,scrollTrigger:{trigger:".title h1",start:"top 50%",end:"top top",toggleActions:"restart none reverse none",scrub:1}})}})),gltfLoader.load("/objects/track.gltf",(function(e){truck=e.scene;for(let e=0;e<truck.children.length;e++)truck.children[e].castShadow=!0;truck.position.set(0,-.5,0),truck.scale.set(.3,.3,.3)})),gltfLoader.load("/objects/box.gltf",(function(e){box=e.scene;for(let e=0;e<box.children.length;e++)box.children[e].castShadow=!0;scene.add(box),box.position.set(0,-5,0),box.scale.set(.3,.3,.3)}));const hemiLight=new THREE.HemisphereLight(16772785,526368,3);scene.add(hemiLight);const spotLight1=new THREE.SpotLight("#F8F8F8",3,1e3);spotLight1.castShadow=!0,scene.add(spotLight1);const spotLight1Helper=new THREE.SpotLightHelper(spotLight1,1);scene.add(spotLight1Helper);const rectLight=new THREE.RectAreaLight("#0077ff",1.5,2e3,2e3);rectLight.position.set(5,50,50),rectLight.lookAt(0,0,0),scene.add(rectLight);const pointLight=new THREE.PointLight("#FEED01",3,1e3,1);pointLight.position.set(5,50,50),scene.add(pointLight);const pointH=new THREE.PointLightHelper(pointLight,1);scene.add(pointH);const sizes={width:window.innerWidth,height:window.innerHeight};window.addEventListener("resize",(()=>{sizes.width=window.innerWidth,sizes.height=window.innerHeight,camera.aspect=sizes.width/sizes.height,camera.updateProjectionMatrix(),renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2))}));const renderer=new THREE.WebGLRenderer({canvas,alpha:!0});renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),renderer.toneMapping=THREE.ReinhardToneMapping,renderer.toneMappingExposure=2.3,renderer.gammaOutput=!0,renderer.shadowMap.enabled=!0;const camera=new THREE.PerspectiveCamera(75,sizes.width/sizes.height,.1,100);camera.position.x=0,camera.position.y=0,camera.position.z=2,scene.add(camera),document.addEventListener("mousemove",onDocumentMouseMove);let mouseX=0,mouseY=0,targetX=0,targetY=0;const windowX=window.innerWidth/2,windowY=window.innerHeight/2;function onDocumentMouseMove(e){mouseX=e.clientX-windowX,mouseY=e.clientY-windowY}const clock=new THREE.Clock,tick=()=>{targetX=.001*mouseX,targetY=.001*mouseY;const e=clock.getElapsedTime();if(camera.position.y>-.3&&japan&&(japan.rotation.x+=.05*(Math.PI/3-targetY-japan.rotation.x),japan.rotation.y+=.5*(targetX-japan.rotation.y)),box)for(const t of box.children)t.rotation.y=.5*e;spotLight1.position.set(camera.position.x+20,camera.position.y+20,camera.position.z+20),rectLight.position.set(camera.position.x+5,camera.position.y+50,camera.position.z+45),rectLight.lookAt(camera.position.x,camera.position.y,camera.position.z),pointLight.position.set(camera.position.x+5,camera.position.y+50,camera.position.z+45),renderer.render(scene,camera),window.requestAnimationFrame(tick)};tick(),navigator.userAgent.indexOf("iPhone")>0||navigator.userAgent.indexOf("Android")>0&&navigator.userAgent.indexOf("Mobile")>0||navigator.userAgent.indexOf("iPad")>0||navigator.userAgent.indexOf("Android")>0||luxy.init({wrapper:"#luxy",targets:".luxy-el",wrapperSpeed:.15}),gsap.from("body",{backgroundColor:"rgba( 254, 237, 1, 1)",ease:"Power3.easeOut",scrollTrigger:{markers:!0,trigger:".title h1",start:"top 50%",end:"top top",toggleActions:"restart none reverse none",scrub:1}}),gsap.from("header",{opacity:0,duration:1,y:-50,ease:"Power2.easeInOut"});let tl1=gsap.timeline({defaults:{ease:"power1.inOut",duration:.5}});if(tl1.to(camera.position,{y:-2,duration:2,scrollTrigger:{markers:!0,trigger:".title h1",start:"top 50%",end:"top top",toggleActions:"restart none reverse none",scrub:1}}),truck)for(const e of truck.children)tl1.to(e.position,{y:-1,duration:1});gsap.to("blockquote .bl-wrap",{left:"100%",width:"150%",ease:"Power1.easeInOut",scrollTrigger:{trigger:"blockquote .bl-wrap",start:"top 60%"}}),gsap.to("blockquote h2",{opacity:1,delay:.1,scrollTrigger:{trigger:"blockquote .bl-wrap",start:"top 60%"}}),gsap.from(".card",{opacity:0,duration:1,y:50,ease:"Power2.easeOut",scrollTrigger:{trigger:".card",start:"top 70%",end:"top 50%",markers:!0,scrub:1}}),gsap.from(".image-container",{backgroundColor:"rgba( 254, 237, 1, 0)",ease:"Power3.easeOut",scrollTrigger:{trigger:".image-container",start:"top 80%",end:"bottom 20%",scrub:1}});