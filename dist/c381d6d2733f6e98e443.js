import"./style.css";import*as THREE from"three";import{OrbitControls}from"three/examples/jsm/controls/OrbitControls.js";import*as dat from"dat.gui";import{Path,PointLightHelper,SphereBufferGeometry}from"three";import{GLTFLoader}from"three/examples/jsm/loaders/GLTFLoader";import luxy from"luxy.js";import gsap from"gsap";import{ScrollTrigger}from"gsap/ScrollTrigger";gsap.registerPlugin(ScrollTrigger);const textureLoader=new THREE.TextureLoader,gltfLoader=new GLTFLoader,gui=new dat.GUI;function getRandomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}const canvas=document.querySelector("canvas.webgl"),scene=new THREE.Scene,light=new THREE.Color(16316664),dark=new THREE.Color(16706817),sizes={width:window.innerWidth,height:window.innerHeight},camera=new THREE.PerspectiveCamera(75,sizes.width/sizes.height,.1,100);camera.position.x=0,camera.position.y=0,camera.position.z=2,scene.add(camera);const hemiLight=new THREE.HemisphereLight(16772785,526368,3);scene.add(hemiLight);const spotLight1=new THREE.SpotLight("#F8F8F8",3,1e3);scene.add(spotLight1);const spotLight1Helper=new THREE.SpotLightHelper(spotLight1,1);scene.add(spotLight1Helper);const rectLight=new THREE.RectAreaLight("#0077ff",1.5,2e3,2e3);rectLight.position.set(5,50,50),rectLight.lookAt(0,0,0),scene.add(rectLight);const pointLight=new THREE.PointLight("#FEED01",3,1e3,1);pointLight.position.set(5,50,50),scene.add(pointLight);const pointH=new THREE.PointLightHelper(pointLight,1);scene.add(pointH),window.addEventListener("resize",(()=>{sizes.width=window.innerWidth,sizes.height=window.innerHeight,camera.aspect=sizes.width/sizes.height,camera.updateProjectionMatrix(),renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2))}));const renderer=new THREE.WebGLRenderer({canvas,alpha:!0});renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),renderer.toneMapping=THREE.ReinhardToneMapping,renderer.toneMappingExposure=3,renderer.outputEncoding=THREE.GammaEncoding,renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap;let japan,tl=gsap.timeline({defaults:{ease:"power1.inOut",duration:1,immediateRender:!1,scrollTrigger:{trigger:".title h1",start:"top 50%",end:"top top",toggleActions:"play pause resume reset",scrub:1}}});var trip,temple,truck;tl.to(camera.position,{y:-2}),gltfLoader.load("/objects/japan3.gltf",(function(e){japan=e.scene;for(let e=0;e<japan.children.length;e++){let t=japan.children[e];t.castShadow=!0,t.receiveShadow=!0}scene.add(japan),japan.position.set(0,0,0),japan.rotation.set(Math.PI/6,Math.PI/6,0),japan.scale.set(.2,.2,.2);for(let e=0;e<=6;e++){let t,r;e<3?(t=.6*e-1,r=11):3<=e&&e<6?(t=.6*(e-3)-1,r=12):(t=-.4,r=13),tl.to(japan.children[e].position,{x:t,y:0,z:r}),tl.to(japan.children[e].rotation,{x:-Math.PI/3,z:0,y:0},"<")}})),tl.to(camera.position,{y:-6,ease:"power1.inOut",duration:2,scrollTrigger:{trigger:".cam1",start:"top 80%",end:"top 10%",toggleActions:"play pause resume reset",scrub:1}}),gltfLoader.load("/objects/trip1.gltf",(function(e){trip=e.scene;for(let e=0;e<trip.children.length;e++)trip.children[e].castShadow=!0;scene.add(trip),trip.position.set(0,-7,0),trip.scale.set(.5,.5,.5),trip.children[2].rotation.set(Math.PI/2,0,0)})),tl.to(camera.position,{y:-9,ease:"power1.inOut",duration:2,scrollTrigger:{trigger:".cam2",start:"top 80%",end:"top 10%",toggleActions:"play pause resume reset",scrub:1}}),gltfLoader.load("/objects/temple3.gltf",(function(e){temple=e.scene;for(let e=0;e<temple.children.length;e++)temple.children[e].castShadow=!0;scene.add(temple),temple.position.set(0,-9,0),temple.scale.set(.3,.3,.3)})),tl.to(camera.position,{x:5,ease:"power0.easeNone",duration:3,scrollTrigger:{trigger:".cam4",start:"top 50%",end:"bottom top",toggleActions:"play pause resume reset",scrub:1}}),tl.to(camera.position,{y:-11,ease:"power0.easeNone",duration:3,scrollTrigger:{trigger:".cam3",start:"top bottom",end:"bottom top",toggleActions:"play pause resume reset",scrub:1}}),gltfLoader.load("/objects/truck3.gltf",(function(e){truck=e.scene;for(let e=0;e<truck.children.length;e++)truck.children[e].castShadow=!0;scene.add(truck),truck.position.set(2,-15,-.5),truck.scale.set(.3,.3,.3),truck.rotation.set(0,Math.PI/2,0),tl.to(truck.position,{y:-11.5,scrollTrigger:{trigger:".cam3",start:"top bottom",end:"top 50%",toggleActions:"play pause resume reset",scrub:1}}),tl.to(truck.rotation,{y:0,scrollTrigger:{trigger:".cam3",start:"top bottom",end:"top 50%",toggleActions:"play pause resume reset",scrub:1}}),tl.to(truck.children[2].position,{x:5,ease:"power0.easeNone",duration:3,scrollTrigger:{trigger:".cam4",start:"top 50%",end:"bottom top",toggleActions:"play pause resume reset",scrub:1}}),tl.to(truck.children[0].position,{x:-5,ease:"power0.easeNone",duration:3,scrollTrigger:{trigger:".cam4",start:"top 50%",end:"bottom top",toggleActions:"play pause resume reset",scrub:1}}),tl.to(truck.position,{y:-10,scrollTrigger:{trigger:".cam5",start:"top bottom",end:"top 50%",toggleActions:"play pause resume reset",scrub:1}})})),tl.to(camera.position,{y:-13,ease:"power0.easeNone",duration:3,scrollTrigger:{trigger:".cam5",start:"top bottom",end:"bottom top",toggleActions:"play pause resume reset",scrub:1}}),document.addEventListener("mousemove",onDocumentMouseMove);let mouseX=0,mouseY=0,targetX=0,targetY=0;const windowX=window.innerWidth/2,windowY=window.innerHeight/2;function onDocumentMouseMove(e){mouseX=e.clientX-windowX,mouseY=e.clientY-windowY}const clock=new THREE.Clock,tick=()=>{targetX=.001*mouseX,targetY=.001*mouseY;const e=clock.getElapsedTime(),t=Math.PI/9,r=2*Math.cos(t*e);Math.sin(t*e),camera.position.y>-.3&&japan&&(japan.rotation.x+=.05*(Math.PI/3-targetY-japan.rotation.x),japan.rotation.y+=.5*(targetX-japan.rotation.y),japan.children[8].position.x=-r,japan.children[7].position.x=r),temple&&(temple.children[5].rotation.y=.5*e),trip&&(trip.children[1].rotation.z=.5*e,trip.children[2].rotation.x=.2*e),spotLight1.position.set(camera.position.x+20,camera.position.y+20,camera.position.z+20),rectLight.position.set(camera.position.x+5,camera.position.y+50,camera.position.z+45),rectLight.lookAt(camera.position.x,camera.position.y,camera.position.z),pointLight.position.set(camera.position.x+5,camera.position.y+50,camera.position.z+45),renderer.render(scene,camera),window.requestAnimationFrame(tick)};tick(),navigator.userAgent.indexOf("iPhone")>0||navigator.userAgent.indexOf("Android")>0&&navigator.userAgent.indexOf("Mobile")>0||navigator.userAgent.indexOf("iPad")>0||navigator.userAgent.indexOf("Android")>0||luxy.init({wrapper:"#luxy",targets:".luxy-el",wrapperSpeed:.2}),gsap.from("body",{backgroundColor:"rgba( 254, 237, 1, 1)",ease:"Power3.easeOut",scrollTrigger:{trigger:".title h1",start:"top 50%",end:"top top",toggleActions:"restart none reverse none",scrub:1}}),gsap.from("header",{opacity:0,duration:1,y:-50,ease:"Power2.easeInOut"}),gsap.to("blockquote .bl-wrap",{left:"100%",width:"150%",ease:"Power1.easeInOut",scrollTrigger:{trigger:"blockquote .bl-wrap",start:"top 60%"}}),gsap.to("blockquote h2",{opacity:1,delay:.1,scrollTrigger:{trigger:"blockquote .bl-wrap",start:"top 60%"}}),gsap.from(".card1",{opacity:0,duration:1,y:50,ease:"Power2.easeOut",scrollTrigger:{trigger:".card1",start:"top 70%",end:"top 60%",scrub:1}}),gsap.from(".graph-container",{opacity:0,duration:1,y:50,ease:"Power2.easeOut",scrollTrigger:{trigger:".graph-container",start:"top 70%",end:"top 50%",scrub:1}}),gsap.from(".card-trip",{opacity:0,duration:1,y:50,ease:"Power2.easeOut",scrollTrigger:{trigger:".card-trip",start:"top 70%",end:"top 60%",scrub:1}}),gsap.from(".card2",{opacity:0,duration:1,y:50,ease:"Power2.easeOut",scrollTrigger:{trigger:".card2",start:"top 70%",end:"top 60%",scrub:1}}),gsap.from(".card3",{opacity:0,x:-50,ease:"Power2.easeOut",scrollTrigger:{trigger:".card3",start:"top 80%",end:"top 40%",scrub:1}}),gsap.from(".card4",{opacity:0,duration:1,y:50,ease:"Power2.easeOut",scrollTrigger:{trigger:".card4",start:"top 70%",end:"top 60%",scrub:1}}),gsap.from(".card5",{opacity:0,duration:1,y:50,ease:"Power2.easeOut",scrollTrigger:{trigger:".card5",start:"top 70%",end:"top 60%",scrub:1}}),gsap.to("body",{backgroundColor:"rgba( 254, 237, 1, 1)",ease:"Power3.easeOut",scrollTrigger:{trigger:".backToggle",start:"top 90%",end:"top 70%",scrub:1,toggleActions:"restart none reverse none",markers:!0}});